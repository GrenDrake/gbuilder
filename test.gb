
function main() {
    local res, mainWindow;

    asm {
        gestalt 4 2 res;
        jz res bad_start;

        setiosys 2 0;

        // glk_window_open
        copy sp 0; // rock
        copy sp 3; // wintype_TextBuffer
        copy sp 0;
        copy sp 0;
        copy sp 0;
        glk 34 5 mainWindow;
        jz mainWindow bad_start;
        label testme;
        
        // glk_set_window
        copy sp mainWindow;
        glk 47 1 0;
    }

    asm {
        streamstr "Hello World!";
        streamchar '\n';
    }

    return;

    label bad_start;
    asm quit;
}